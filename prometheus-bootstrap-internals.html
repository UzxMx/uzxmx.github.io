<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Prometheus bootstrap internals - Mingxiangâ€™s blog</title>
<meta name="description" content="Prometheus is a system and service monitoring system. It collects metrics from configured targets at given intervals, evaluates rule expressions, displays the results, and can trigger alerts if some condition is observed to be true.  ">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Mingxiang's blog">
<meta property="og:title" content="Prometheus bootstrap internals">
<meta property="og:url" content="https://uzxmx.github.io/prometheus-bootstrap-internals.html">


  <meta property="og:description" content="Prometheus is a system and service monitoring system. It collects metrics from configured targets at given intervals, evaluates rule expressions, displays the results, and can trigger alerts if some condition is observed to be true.  ">







  <meta property="article:published_time" content="2020-05-24T14:25:00+08:00">






<link rel="canonical" href="https://uzxmx.github.io/prometheus-bootstrap-internals.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://uzxmx.github.io/"
    
  }
</script>


  <meta name="google-site-verification" content="4cV_DkFkOihbmPCkF3LqIVBC3lM0yA0UhentAgp7Mmg" />


  <meta name="msvalidate.01" content="E2FD20A4199C5CDBE9E4842CCD5820E0">




<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Mingxiang's blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <link href="/assets/styles/snippet.css" rel="stylesheet" type="text/css">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Mingxiang's blog
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Prometheus bootstrap internals">
    <meta itemprop="description" content="Prometheus is a system and service monitoring system. It collects metrics fromconfigured targets at given intervals, evaluates rule expressions, displays theresults, and can trigger alerts if some condition is observed to be true.">
    <meta itemprop="datePublished" content="2020-05-24T14:25:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Prometheus bootstrap internals
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Prometheus is a system and service monitoring system. It collects metrics from
configured targets at given intervals, evaluates rule expressions, displays the
results, and can trigger alerts if some condition is observed to be true.</p>

<p>This series of articles try to dig deeply into Prometheus internals to help readers
understand Prometheus well. The dig is based on Prometheus v2.18.1.</p>

<p class="notice--info"><strong>Tip:</strong> For more information about Prometheus, please visit
<a href="https://github.com/prometheus/prometheus">here</a>.</p>

<h2 id="actors">Actors</h2>

<p>Prometheus starts up from <code class="highlighter-rouge">cmd/prometheus/main.go</code>. Inside <code class="highlighter-rouge">main</code> function, It
prepares a group of actors (functions) and runs them concurrently. Actors
include:</p>

<ul>
  <li>Actor that handles application termination.</li>
  <li>Actor that manages scrape discovery.</li>
  <li>Actor that manages notification discovery.</li>
  <li>Actor that manages scrape.</li>
  <li>Actor that handles reloading configuration.</li>
  <li>Actor that handles initial configuration loading. After loading, It executes a
list of <code class="highlighter-rouge">ApplyConfig</code> functions to initialize other actors.  <code class="highlighter-rouge">reloadReady</code>
channel will also be closed to notify other actors to proceed.</li>
  <li>Actor that manages rules.</li>
  <li>Actor that handles TSDB.</li>
  <li>Actor that handles web requests.</li>
  <li>Actor that sends notifications.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-05-24T14:25:00+08:00">May 24, 2020</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/renew-certificates-inside-outside-kubernetes.html" class="pagination--pager" title="Renew SSL certificates inside and outside Kubernetes
">Previous</a>
    
    
      <a href="/prometheus-scrape-internals.html" class="pagination--pager" title="Prometheus scrape internals
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <section id="custom-comments"></section>
  
</div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Mingxiang's blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  
    <script src="/assets/scripts/snippet.js"></script>
  







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-164919405-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-164919405-1', { 'anonymize_ip': false});
</script>






    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" />
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script>
    var gitalk = new Gitalk({
      clientID: 'b520e04f320af9c44fa8',
      clientSecret: '9c2486428baddfcf9703cdf1f7e6b42fc8f3e0b9',
      repo: 'uzxmx.github.io',
      owner: 'uzxmx',
      admin: ['uzxmx'],
      id: location.pathname
    });

    gitalk.render('custom-comments');
  </script>
  <noscript>Please enable JavaScript to view the comments powered by Gitalk.</noscript>








  </body>
</html>
